<!-- ==================== -->
<!-- Paste your exported SVG code below this line.                 -->
<!-- Make sure each frame group has an id like frame-01, frame-02. -->
<?xml version="1.0" encoding="UTF-8"?>
<svg id="Layer_4" data-name="Layer 4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1920 1080">
  <g id="frame-19">
    <path d="M1059.84,882.42c-7.13.41-14.86-.04-22.08,0-.63,0-1.29,0-1.92,0s-1.29,0-1.92,0c-4.47.02-8.97-.01-13.44,0-2.23,0-4.49,0-6.72,0-.63,0-1.29,0-1.92,0-.96,0-1.92,0-2.88,0-3.19,0-6.41,0-9.6,0-.63,0-1.29,0-1.92,0-2.55,0-5.13,0-7.68,0-8.63-.02-17.29.04-25.92,0-.63,0-1.29,0-1.92,0-5.08-.03-10.29.23-15.36,0-1.11-.05-2.24.03-3.36,0-.16-.05-2.35-2.23-2.4-2.4-.49-1.77.03-6.75,0-9.11l1.92-4.8,2.88,1.92.96,6.71c1.05-.15,2.47.24,3.36,0,.62-.17,8.94-8.49,9.12-9.11s-.18-1.35,0-1.92c.13-.4.9-.61.96-.96.74-4.13-1.28-10.02.96-13.43-2.05-37.47-.96-77.62,0-115.1.26-10.23-1.5-25.37,0-33.57.14-.78.18-3.18,0-3.84-.15-.56-7-7.15-8.16-8.15-.72-.62-2.31-.49-3.36-2.88-.68-1.55-1.36-.89-1.44-.96-2.08-1.87-2.87-2.71-2.4-5.75l-2.88,4.32-.96-3.36c.32-.78-.17-2.05,1.44-2.88l120.96-.96,1.44,1.44.96,202.38c-1.94,2.33-4.08,2.25-6.72,2.4ZM953.28,684.83l9.12,9.59h75.36c1.39,1.01,4.56,1.42,6.24.96,1.35-.37,10.21-10.59,12-12.47-2.35-.16-4.88.22-7.2,0-23.91-2.31-50.68-1.04-75.36-.96-7.67.02-15.37-.02-23.04,0-.27,1.93,1.19,3.18,2.88,2.88ZM1057.92,685.79l-10.56,9.11c.23,8.3-.32,16.65,0,24.94.12,3.07,2.36,14.78.96,17.74-1.03,2.19-.62,8.55,0,11.51v114.62c1.84,1.54,3.43,3.84,5.28,5.28.19.15.75-.16.96,0,.83.62,5.44,4.73,6.24,3.84.68-18.19-.91-37.03,0-55.15.28-5.62.28-8.77,0-14.39-.72-14.41,2.38-39.69-.96-51.79-.35-1.26.87-1.53.96-1.92.63-2.81.18-11.9,0-15.35-.06-1.07.46-2.38-.96-2.4.41-7.88.86-16.44.96-24.94,0-.32,0-.64,0-.96.05-5.56-.86-14.72,0-19.66.05-.28,1.51-.98.96-2.88-.08-.27-1.44-1.91-1.92-.96l-1.92,3.36ZM970.56,702.1h69.12l.96-3.36c-.79-.99-1.12-1.26-2.4-1.44-3.15-.44-7.13-2.02-9.6,0h-61.92c.68,1.57,2.14,3.17,3.84,2.88.01.63-.03,1.29,0,1.92l-6.72-2.88c.34,21.39-.45,42.88,0,64.26.01.63-.02,1.29,0,1.92.1,3-.13,3.35.96,5.75.07.15.05.76,0,.96-.17.7-.39,1.01-.96,1.44v84.4l1.44,3.36,3.84-3.84h1.44v-76.25c1.56-2,1.07-6.24.96-9.11-.02-.63.01-1.28,0-1.92l-1.92-.96h69.6c.66.16.43.94.48.96.22,2.05-.81,3.16-.96,5.28-1.72,24.31.5,51.06.96,74.81v8.15c-.07-.4.11-.82-.48-.96-5.51.83-14.17-1.12-19.2,0-.44.1-.88,1.51-1.92.96-5.84-4.11-15-1.19-21.12-.96-7.66.29-15.37-.21-23.04,0l-6.24,5.75h73.92c-.07-.62.13-1.41,0-1.92-.28-1.08-1.35-1.43-.96-2.88l1.92,2.88c1.79.22,2.78.04,3.84-1.44l-.96-91.6c-1.98-.5-1.81.9-1.92.96-.7.35-2.08.08-1.92-.96.34-2.63-.53-5.03-2.4-6.71h-58.56c-1.81-2.06-6.17-.67-8.16.96-.82.1-.9-.22-.96-.96-.61-7.81.22-16.48,0-24.46,0-.33-.95-.63-.96-.96-.29-11.32.47-22.75,0-34.05ZM1045.44,699.22c-3.95-.78-3.93,3.52-6.72,5.28-.55,1.91.91,2.6.96,2.88,1.27,7.12-.78,16.51-.96,23.02-.27,9.58.2,19.19,0,28.77,1.23,1.69,2.96,2.19,4.32.48l2.4,2.88v-63.3ZM975.36,706.89v46.52c0,.21,1.78,2.88,2.4,3.36h55.2l.96-49.88c-5.89-.17-11.86.24-17.76,0-.33-.01-.63-.95-.96-.96-9.67-.35-27.56-1.29-36.48,0-.31.04-1.68,1.71-3.36.96ZM1033.92,773.07h-57.6v80.57l56.64-.96.96-79.61ZM965.76,867.07h-2.4c-.47,1.08-1.66.8-1.92.96-1.59,1.01-1.64,2.9-4.8,4.8-1.43.85-3.27,1.59-4.32,2.88-.15-.07-.76-.05-.96,0-1.52.37-2.5,2.63-3.36,2.88-1.42.41-3.66-.81-4.32,1.92h107.52l.96-2.88c2.05.05,4.19.1,6.24,0,1.55-.08,2.74-.8,1.44-1.92-4.24-.16-6.15-4.56-9.12-6.71-.4-.29-2.26-.51-2.88-1.92-12.15-.18-24.33.24-36.48,0-.33,0-.63-.95-.96-.96-11.98-.23-29.41,1.41-39.36,0-1.2-.17-4.81-.55-5.28.96Z" fill="#150a0c"/>
    <!-- ... SVG content truncated for brevity ... -->
</svg>
<!-- ==================== -->
<!-- End SVG                                                   -->

<style>
.frame-hover-number {
  position: absolute;
  color: #341D34;
  background: #f6ff8f;
  border-radius: 0.2em;
  font-family: 'Fira Mono', monospace;
  font-size: 1.2rem;
  font-weight: 700;
  padding: 2px 10px;
  pointer-events: none;
  z-index: 10;
  box-shadow: 0 2px 8px rgba(0,0,0,0.05);
  display: none;
  align-items: center;
  justify-content: center;
  text-align: center;
}

.frame-button {
  position: absolute;
  color: #341D34;
  background: #f6ff8f;
  border-radius: 0.2em;
  font-family: 'Fira Mono', monospace;
  font-size: 1.2rem;
  font-weight: 700;
  padding: 2px 10px;
  z-index: 10;
  box-shadow: 0 2px 8px rgba(0,0,0,0.05);
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  cursor: pointer;
  transition: background-color 0.2s ease;
}

.frame-button.active {
  background: #ffb6c1;
}

.compose-button {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background: #341D34;
  color: white;
  border: none;
  padding: 12px 24px;
  border-radius: 0.5em;
  font-family: 'Fira Mono', monospace;
  font-size: 1rem;
  font-weight: 700;
  cursor: pointer;
  z-index: 1000;
  display: none;
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
  transition: all 0.2s ease;
}

.compose-button:hover {
  background: #4a2a4a;
  transform: translateY(-2px);
}

.alignment-section {
  position: fixed;
  top: 20px;
  right: 20px;
  min-width: 200px;
  max-width: 400px;
  background: white;
  border: 2px solid #341D34;
  border-radius: 0.5em;
  padding: 20px;
  font-family: 'Fira Mono', monospace;
  font-size: 0.9rem;
  z-index: 1000;
  display: none;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  word-wrap: break-word;
  overflow-wrap: break-word;
}

.alignment-section h3 {
  margin: 0 0 15px 0;
  color: #341D34;
  font-size: 1.1rem;
}

.alignment-section p {
  margin: 0;
  line-height: 1.5;
  color: #341D34;
}
</style>
<script>
document.addEventListener('DOMContentLoaded', function() {
  const svg = document.querySelector('svg');
  if (!svg) return;

  // Create containers
  const numberDiv = document.createElement('div');
  numberDiv.className = 'frame-hover-number';
  document.body.appendChild(numberDiv);

  const composeButton = document.createElement('button');
  composeButton.className = 'compose-button';
  composeButton.textContent = 'compose';
  document.body.appendChild(composeButton);

  const alignmentSection = document.createElement('div');
  alignmentSection.className = 'alignment-section';
  alignmentSection.innerHTML = '<h3>Alignment</h3><p id="alignment-text"></p>';
  document.body.appendChild(alignmentSection);

  // State management
  const activeButtons = new Map(); // frameId -> button element
  const clickedOrder = []; // Array to track click order

  // Helper to get the number from id (e.g., 'frame-01' -> '01')
  function getFrameNumber(id) {
    const match = id.match(/^frame-(\d+)$/);
    return match ? match[1] : '';
  }

  // Helper to create a persistent button
  function createButton(frameId, x, y) {
    const button = document.createElement('div');
    button.className = 'frame-button';
    button.textContent = getFrameNumber(frameId);
    button.style.left = x + 'px';
    button.style.top = y + 'px';
    button.dataset.frameId = frameId;
    
    button.addEventListener('click', function() {
      toggleButton(frameId);
    });
    
    return button;
  }

  // Toggle button state
  function toggleButton(frameId) {
    const button = activeButtons.get(frameId);
    if (button) {
      // Remove button
      button.remove();
      activeButtons.delete(frameId);
      // Remove from clicked order
      const index = clickedOrder.indexOf(frameId);
      if (index > -1) {
        clickedOrder.splice(index, 1);
      }
    } else {
      // Add button
      const num = getFrameNumber(frameId);
      if (!num) return;
      
      // Get position from the frame group
      const frameGroup = document.getElementById(frameId);
      if (!frameGroup) return;
      
      const bbox = frameGroup.getBBox();
      const pt = svg.createSVGPoint();
      pt.x = bbox.x + bbox.width / 2;
      pt.y = bbox.y;
      const ctm = svg.getScreenCTM();
      if (!ctm) return;
      const screenPt = pt.matrixTransform(ctm);
      
      const button = createButton(frameId, screenPt.x - 25, screenPt.y - 36);
      document.body.appendChild(button);
      activeButtons.set(frameId, button);
      
      // Add to clicked order
      clickedOrder.push(frameId);
    }
    
    // Show/hide compose button based on whether any buttons are active
    composeButton.style.display = activeButtons.size > 0 ? 'block' : 'none';
  }

  // Find all <g> with id starting with 'frame-'
  const frameGroups = Array.from(svg.querySelectorAll('g[id^="frame-"]'));

  frameGroups.forEach(g => {
    g.addEventListener('mouseenter', function(e) {
      const id = g.id;
      const num = getFrameNumber(id);
      if (!num || activeButtons.has(id)) return; // Don't show hover if button is active
      
      numberDiv.textContent = num;
      numberDiv.style.display = 'flex';

      // Get the bounding box of the group in SVG coordinates
      const bbox = g.getBBox();
      // Convert SVG coordinates to screen coordinates
      const pt = svg.createSVGPoint();
      pt.x = bbox.x + bbox.width / 2;
      pt.y = bbox.y;
      const ctm = svg.getScreenCTM();
      if (!ctm) return;
      const screenPt = pt.matrixTransform(ctm);
      // Position the numberDiv above the group (top of yellow block)
      numberDiv.style.left = (screenPt.x - numberDiv.offsetWidth / 2) + 'px';
      numberDiv.style.top = (screenPt.y - 36) + 'px'; // 36px above the top
    });
    
    g.addEventListener('mousemove', function(e) {
      const id = g.id;
      if (activeButtons.has(id)) return; // Don't update hover if button is active
      
      // Update position in case of movement
      const bbox = g.getBBox();
      const pt = svg.createSVGPoint();
      pt.x = bbox.x + bbox.width / 2;
      pt.y = bbox.y;
      const ctm = svg.getScreenCTM();
      if (!ctm) return;
      const screenPt = pt.matrixTransform(ctm);
      numberDiv.style.left = (screenPt.x - numberDiv.offsetWidth / 2) + 'px';
      numberDiv.style.top = (screenPt.y - 36) + 'px';
    });
    
    g.addEventListener('mouseleave', function() {
      numberDiv.style.display = 'none';
    });
    
    g.addEventListener('click', function(e) {
      e.preventDefault();
      toggleButton(g.id);
    });
  });

  // Compose button click handler
  composeButton.addEventListener('click', function() {
    if (clickedOrder.length === 0) return;
    
    // Generate story based on click order
    const story = generateStory(clickedOrder);
    
    // Display in alignment section
    const alignmentText = document.getElementById('alignment-text');
    alignmentText.textContent = story;
    alignmentSection.style.display = 'block';
  });

  // Generate AI story based on click order
  function generateStory(clickOrder) {
    const numbers = clickOrder.map(id => getFrameNumber(id));
    const sequence = numbers.join(' â†’ ');
    
    // Stories designed to be 150-200 words
    const stories = [
      `Following the constellation sequence ${sequence}, a cosmic dance unfolds where each frame reveals a fragment of an ancient celestial story. The alignment suggests a journey through time and space, where every number represents a chapter in the universe's grand narrative. As the stars align in this precise order, they whisper secrets of creation itself.`,
      
      `The pattern ${sequence} creates a mystical pathway through the stars. Each number acts as a beacon, guiding the way through cosmic currents and stellar winds. This alignment speaks of destiny written in the heavens, where every choice leads to another constellation, another story waiting to be told.`,
      
      `In the sequence ${sequence}, we find the rhythm of creation itself. Each frame pulses with cosmic energy, building a symphony of light and shadow that tells the story of how the universe came to be. The numbers form a celestial code, unlocking memories of the first starlight.`,
      
      `The constellation alignment ${sequence} reveals a hidden message from the cosmos. Each number is a key that unlocks deeper understanding of the celestial mechanics that govern our reality. Through this pattern, we glimpse the mathematical poetry of existence.`,
      
      `Through the pattern ${sequence}, we trace the footsteps of ancient stargazers who mapped the heavens. Each frame preserves their wisdom, passed down through generations of sky-watchers who understood that every constellation tells a story of human connection to the infinite.`,
      
      `The sequence ${sequence} forms a celestial bridge between past and future. Each number represents a moment in cosmic time, a point where the universe paused to create something beautiful. This alignment is a reminder that we are all stardust, connected by invisible threads of light.`,
      
      `As the constellations align in order ${sequence}, they reveal the hidden geometry of the cosmos. Each frame is a window into another dimension, where time flows differently and space bends to the will of ancient forces. This pattern is a map to understanding our place in the universe.`,
      
      `The constellation sequence ${sequence} creates a sacred geometry that has guided travelers for millennia. Each number represents a waypoint in the great cosmic journey, a moment of revelation where the mysteries of the universe become slightly less mysterious.`
    ];
    
    // Return a random story (or you could make it deterministic based on the sequence)
    return stories[Math.floor(Math.random() * stories.length)];
  }
});
</script>
